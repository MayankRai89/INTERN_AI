const translations = {
  en: {
    brand: "PM Internship Scheme",
    "landing.tagline": "Find the internship that fits you best",
    "landing.cta": "Find My Internship",
    "landing.desc": "Discover curated opportunities across technology, finance, policy, healthcare and more. Tailored to your profile.",
    "card.students.title": "Students",
    "card.students.sub": "For undergrads & postgrads",
    "card.tech.title": "Tech-ready",
    "card.tech.sub": "Projects with real impact",
    "card.offices.title": "Offices & Remote",
    "card.offices.sub": "Government & private partners",

    "login.title": "Login / Signup",
    "field.fullname": "Full Name",
    "ph.fullname": "Enter your full name",
    "field.age": "Age",
    "ph.age": "21",
    "field.gender": "Gender",
    "opt.gender.select": "Select",
    "opt.gender.male": "Male",
    "opt.gender.female": "Female",
    "opt.gender.other": "Other",
    "field.location": "Location",
    "ph.location": "City, State",
    "field.phone": "Phone Number",
    "ph.phone": "+91 00000 00000",
    "field.aadhaar": "Aadhaar Number",
    "ph.aadhaar": "XXXX-XXXX-XXXX",
    "field.email": "Email (Optional)",
    "ph.email": "you@example.com",
    "btn.verify": "Verify & Continue",
    "btn.useLocation": "Use my location",
    "loc.noResults": "No results",
    "loc.permissionDenied": "Location permission denied",

    "edu.title": "Education Details",
    "edu.10": "10th % / Board / Year",
    "ph.edu.10": "e.g., 86% CBSE 2018",
    "edu.12": "12th % / Board / Year",
    "ph.edu.12": "e.g., 90% CBSE 2020",
    "edu.ug": "UG Degree / Branch / CGPA",
    "ph.edu.ug": "e.g., B.Tech CSE 8.2",
    "edu.pg": "PG Degree / Branch / CGPA",
    "ph.edu.pg": "e.g., M.Tech AI 8.8",
    "edu.extra": "Extra Qualifications",
    "ph.edu.extra": "Certifications, Courses, etc.",
    "edu.resume": "Upload Resume (PDF)",
    "edu.resume.hint": "PDF only, max 5 MB",
    "btn.next": "Next",

    "skills.title": "Select Your Skills",
    "skills.addPlaceholder": "Add a custom skill",
    "skills.add": "Add",
    "skills.minAlert": "Please select at least one skill.",
    "skills.js": "JavaScript",
    "skills.py": "Python",
    "skills.data": "Data Analysis",
    "skills.pm": "Project Management",
    "skills.policy": "Public Policy",
    "skills.health": "Healthcare",
    "skills.sustain": "Sustainability",
    "skills.teach": "Teaching",
    "skills.hr": "Human Resources",
    "skills.civil": "Civil Engineering",
    "skills.rural": "Rural Outreach",

    "btn.continue": "Continue",

    "rec.title": "Recommendations",
    "rec.desc": "This page will show tailored recommendations based on your profile and selected field. We can add the full card layout when you’re ready.",
    "btn.back": "Back to Home",
  },
  hi: {
    brand: "पीएम इंटर्नशिप योजना",
    "landing.tagline": "जो इंटर्नशिप आपके लिए सबसे उपयुक्त हो उसे खोजें",
    "landing.cta": "मेरी इंटर्नशिप ढूँढें",
    "landing.desc": "टेक्नोलॉजी, वित्त, नीति, हेल्थकेयर और अधिक में चुने हुए अवसर। आपके प्रोफ़ाइल के अनुरूप।",
    "card.students.title": "विद्यार्थी",
    "card.students.sub": "स्नातक और परास्नातक के लिए",
    "card.tech.title": "टेक-रेडी",
    "card.tech.sub": "वास्तविक प्रभाव वाले प्रोजेक्ट्स",
    "card.offices.title": "ऑफिस और रिमोट",
    "card.offices.sub": "सरकारी और निजी भागीदार",

    "login.title": "लॉगिन / साइन अप",
    "field.fullname": "पूरा नाम",
    "ph.fullname": "अपना पूरा नाम लिखें",
    "field.age": "आयु",
    "ph.age": "21",
    "field.gender": "लिंग",
    "opt.gender.select": "चुनें",
    "opt.gender.male": "पुरुष",
    "opt.gender.female": "महिला",
    "opt.gender.other": "अ���्य",
    "field.location": "स्थान",
    "ph.location": "शहर, राज्य",
    "field.phone": "फोन नंबर",
    "ph.phone": "+91 00000 00000",
    "field.aadhaar": "आधार नंबर",
    "ph.aadhaar": "XXXX-XXXX-XXXX",
    "field.email": "ईमेल (वैकल्पिक)",
    "ph.email": "you@example.com",
    "btn.verify": "सत्यापित करें और आगे बढ़ें",
    "btn.useLocation": "मेरा स्थान उपयोग करें",
    "loc.noResults": "कोई परिणाम नहीं",
    "loc.permissionDenied": "स्थान की अनुमति अस्वीकृत",

    "edu.title": "शिक्षा विवरण",
    "edu.10": "10वीं % / बोर्ड / वर्ष",
    "ph.edu.10": "उदा., 86% CBSE 2018",
    "edu.12": "12वीं % / बोर्ड / वर्ष",
    "ph.edu.12": "उदा., 90% CBSE 2020",
    "edu.ug": "यूजी डिग्री / शाखा / सीजीपीए",
    "ph.edu.ug": "उदा., B.Tech CSE 8.2",
    "edu.pg": "पीजी डिग्री / शाखा / सीजीपीए",
    "ph.edu.pg": "उदा., M.Tech AI 8.8",
    "edu.extra": "अतिरिक्त योग्यताएँ",
    "ph.edu.extra": "प्रमाणपत्र, पाठ्यक्रम आदि",
    "edu.resume": "रिज़्यूमे अपलोड करें (PDF)",
    "edu.resume.hint": "केवल PDF, अधिकतम 5 एमबी",
    "btn.next": "आगे",

    "skills.title": "अपनी कौशल चुनें",
    "skills.addPlaceholder": "कस्टम कौशल जोड़ें",
    "skills.add": "जोड़ें",
    "skills.minAlert": "कम से कम एक कौशल चुनें।",
    "skills.js": "जावास्क्रिप्ट",
    "skills.py": "पायथन",
    "skills.data": "डेटा विश्लेषण",
    "skills.pm": "प्रोजेक्ट प्रबंधन",
    "skills.policy": "लोक नीति",
    "skills.health": "हेल्थकेयर",
    "skills.sustain": "स्थिरता",
    "skills.teach": "शिक्षण",
    "skills.hr": "मानव संसाधन",
    "skills.civil": "सिविल इंजीनियरिंग",
    "skills.rural": "ग्रामीण पहुंच",

    "btn.continue": "जारी रखें",

    "rec.title": "सिफारिशें",
    "rec.desc": "यह पेज आपकी प्रोफ़ाइल और चुने गए कौशल के आधार पर सिफारिशें दिखाएगा। हम पूर्ण कार्ड लेआउट जोड़ सकते हैं।",
    "btn.back": "होम पर वापस जाएँ",
  },
  ta: {
    brand: "பிரதமர் இன்டர்ன்ஷிப் திட்டம்",
    "landing.tagline": "உங்களுக்கு பொருந்தும் இன்டர்ன்ஷிப் கண்டுபிடிக்கவும்",
    "landing.cta": "என் இன்டர்ன்ஷிப் தேடு",
    "landing.desc": "தொழில்நுட்பம், நிதி, கொள்கை, சுகாதாரம் போன்ற துறைகளில் தேர்ந்தெடுக்கப்பட்ட வாய்ப்புகள். உங்கள் சுயவிவரத்திற்கு ஏற்ப.",
    "card.students.title": "மாணவர்கள்",
    "card.students.sub": "பட்டப்படிப்பு மற்றும��� மேல்படிப்புக்கு",
    "card.tech.title": "டெக்-ரெடி",
    "card.tech.sub": "உண்மையான தாக்கம் கொண்ட திட்டங்கள்",
    "card.offices.title": "அலுவலகம் & தொலைதூரம்",
    "card.offices.sub": "அரசு & தனியார் கூட்டாளர்கள்",

    "login.title": "உள்நுழை / பதிவு",
    "field.fullname": "முழு பெயர்",
    "ph.fullname": "உங்கள் முழு பெயரை எழுதவும்",
    "field.age": "வயது",
    "ph.age": "21",
    "field.gender": "பாலினம்",
    "opt.gender.select": "தேர்வு",
    "opt.gender.male": "ஆண்",
    "opt.gender.female": "பெண்",
    "opt.gender.other": "மற்றவை",
    "field.location": "இடம்",
    "ph.location": "நகரம், மாநிலம்",
    "field.phone": "தொலைபேசி எண்",
    "ph.phone": "+91 00000 00000",
    "field.aadhaar": "ஆதார் எண்",
    "ph.aadhaar": "XXXX-XXXX-XXXX",
    "field.email": "மின்னஞ்சல் (விருப்பம���)",
    "ph.email": "you@example.com",
    "btn.verify": "சரிபார்த்து தொடரவும்",
    "btn.useLocation": "என் இருப்பிடத்தை பயன்படுத்து",
    "loc.noResults": "முடிவுகள் இல்லை",
    "loc.permissionDenied": "இருப்பிட அனுமதி மறுக்கப்பட்டது",

    "edu.title": "கல்வி விவரங்கள்",
    "edu.10": "10ம் % / வாரியம் / ஆண்டு",
    "ph.edu.10": "உதா., 86% CBSE 2018",
    "edu.12": "12ம் % / வாரியம் / ஆண்டு",
    "ph.edu.12": "உதா., 90% CBSE 2020",
    "edu.ug": "UG பட்டம் / பிரிவு / CGPA",
    "ph.edu.ug": "உதா., B.Tech CSE 8.2",
    "edu.pg": "PG பட்டம் / பிரிவு / CGPA",
    "ph.edu.pg": "உதா., M.Tech AI 8.8",
    "edu.extra": "கூடுதல் தகுதிகள்",
    "ph.edu.extra": "சான்றிதழ்கள், பாடநெறிகள், முதலியவை",
    "edu.resume": "ரெச்யூமே பதிவேற்று (PDF)",
    "edu.resume.hint": "PDF மட்டும், ���திகபட்சம் 5 MB",
    "btn.next": "அடுத்தது",

    "skills.title": "உங்கள் திறன்களைத் தேர்வு செய்யவும்",
    "skills.addPlaceholder": "சொந்த திறனைச் சேர்க்கவும்",
    "skills.add": "சேர்",
    "skills.minAlert": "குறைந்தது ஒரு திறனைத் தேர்வு செய்யவும்.",
    "skills.js": "ஜாவாஸ்கிரிப்ட்",
    "skills.py": "பைதான்",
    "skills.data": "தரவு பகுப்பாய்வு",
    "skills.pm": "திட்ட மேலாண்மை",
    "skills.policy": "பொது கொள்கை",
    "skills.health": "சுகாதாரம்",
    "skills.sustain": "திடத்தன்மை",
    "skills.teach": "கற்பித்தல்",
    "skills.hr": "மனிதவள மேலாண்மை",
    "skills.civil": "சிவில் என்ஜினியரிங்",
    "skills.rural": "ஊரக தொடர்பு",

    "btn.continue": "தொடரவும்",

    "rec.title": "பரிந்துரைகள்",
    "rec.desc": "உங்கள் சுயவிவரமும் திறன்களும் அடிப்படையில் பரிந்துரைகள் காட்டப்படும்.",
    "btn.back": "முகப்புக்கு திரும்ப",
  },
  bn: {
    brand: "পিএম ইন্টার্নশিপ স্কিম",
    "landing.tagline": "যে ইন্টার্নশিপটি আপনার জন্য সবচেয়ে উপযুক্ত তা খুঁজুন",
    "landing.cta": "আমার ইন্টার্নশিপ খুঁজুন",
    "landing.desc": "প্রযুক্তি, ফাইন্যান্স, নীতি, স্বাস্থ্যসেবা ইত্যাদি ক্ষেত্রে বাছাইকৃত সুযোগ। আপনার প্রোফাইল অনুযায়ী।",
    "card.students.title": "শিক্ষার্থীরা",
    "card.students.sub": "স্নাতক ও স্নাতকোত্তরদের জন্য",
    "card.tech.title": "টেক-রেডি",
    "card.tech.sub": "বাস্তব প্রভাবশালী প্রকল্প",
    "card.offices.title": "অফিস ও রিম��ট",
    "card.offices.sub": "সরকারি ও বেসরকারি অংশীদার",

    "login.title": "লগইন / সাইনআপ",
    "field.fullname": "পূর্ণ নাম",
    "ph.fullname": "আপনার পূর্ণ নাম লিখুন",
    "field.age": "বয়স",
    "ph.age": "21",
    "field.gender": "লিঙ্গ",
    "opt.gender.select": "নির্বাচন করুন",
    "opt.gender.male": "পুরুষ",
    "opt.gender.female": "মহিলা",
    "opt.gender.other": "অন্যান্য",
    "field.location": "অবস্থান",
    "ph.location": "শহর, রাজ্য",
    "field.phone": "ফোন নম্বর",
    "ph.phone": "+91 00000 00000",
    "field.aadhaar": "আধার নম্বর",
    "ph.aadhaar": "XXXX-XXXX-XXXX",
    "field.email": "ইমেইল (ঐচ্ছিক)",
    "ph.email": "you@example.com",
    "btn.verify": "যাচাই করে এগিয়ে যান",
    "btn.useLocation": "আমার অবস্থান ব্যবহার করুন",
    "loc.noResults": "কোন ফলাফল নেই",
    "loc.permissionDenied": "লোকেশন অনুমতি অস্বীকৃত",

    "edu.title": "শিক্ষার বিবরণ",
    "edu.10": "দশম % / বোর্ড / বছর",
    "ph.edu.10": "যেম��, 86% CBSE 2018",
    "edu.12": "দ্বাদশ % / বোর্ড / বছর",
    "ph.edu.12": "যেমন, 90% CBSE 2020",
    "edu.ug": "UG ডিগ্রি / শাখা / CGPA",
    "ph.edu.ug": "যেমন, B.Tech CSE 8.2",
    "edu.pg": "PG ডিগ্রি / শাখা / CGPA",
    "ph.edu.pg": "যেমন, M.Tech AI 8.8",
    "edu.extra": "অতিরিক্ত যোগ্যতা",
    "ph.edu.extra": "সার্টিফিকেট, কোর্স ইত্যাদি",
    "edu.resume": "রিজিউম আপলোড করুন (PDF)",
    "edu.resume.hint": "শুধু PDF, সর্বোচ্চ 5 এমবি",
    "btn.next": "পরবর্তী",

    "skills.title": "আপনার দক্ষতা নির্বাচন করুন",
    "skills.addPlaceholder": "কাস্টম স্কিল যোগ করুন",
    "skills.add": "যোগ করুন",
    "skills.minAlert": "কমপক্ষে একটি দক্ষতা নির্বাচন করুন।",
    "skills.js": "জাভাস্ক্রিপ্ট",
    "skills.py": "পাইথন",
    "skills.data": "ডাটা অ্যানালাইসিস",
    "skills.pm": "প্রজেক্ট ম্যানেজমেন্ট",
    "skills.policy": "পাবলিক পলিসি",
    "skills.health": "স্বাস্থ্যসেবা",
    "skills.sustain": "টেকসই উন্নয়ন",
    "skills.teach": "শিক্ষাদান",
    "skills.hr": "এইচআর",
    "skills.civil": "সিভিল ইঞ্জিনিয়ারিং",
    "skills.rural": "গ্রামীণ আউটরিচ",

    "btn.continue": "চালিয়ে যান",

    "rec.title": "প্রস্তাবনা",
    "rec.desc": "আপনার প্রোফাইল ও দক্ষতার উপর ভিত্তি করে প্রস্তাবিত ইন্টার্নশিপ দেখানো হবে।",
    "btn.back": "হোমে ফিরে যান",
  },
  mr: {
    brand: "पीएम इंटर्नशिप योजना",
    "landing.tagline": "तुमच्यासाठी योग्य इंटर्नशिप शोधा",
    "landing.cta": "माझी इंटर्नशिप शोधा",
    "landing.desc": "तंत्रज्ञान, वित्त, धोरण, आरोग्य इ. क्��ेत्रातील निवडक संधी. तुमच्या प्रोफाइलनुसार.",
    "card.students.title": "विद्यार्थी",
    "card.students.sub": "पदवी व पदव्युत्तरांसाठी",
    "card.tech.title": "टेक-रेडी",
    "card.tech.sub": "खऱ्या प्रभावाचे प्रकल्प",
    "card.offices.title": "ऑफिस व रिमोट",
    "card.offices.sub": "सरकारी व खाजगी भागीदार",

    "login.title": "लॉगिन / साइनअप",
    "field.fullname": "पूर्ण नाव",
    "ph.fullname": "तुमचे पूर्ण नाव लिहा",
    "field.age": "वय",
    "ph.age": "21",
    "field.gender": "लिंग",
    "opt.gender.select": "निवडा",
    "opt.gender.male": "पुरुष",
    "opt.gender.female": "महिला",
    "opt.gender.other": "इतर",
    "field.location": "स्थान",
    "ph.location": "शहर, राज्य",
    "field.phone": "फोन नंबर",
    "ph.phone": "+91 00000 00000",
    "field.aadhaar": "आधार क्रमांक",
    "ph.aadhaar": "XXXX-XXXX-XXXX",
    "field.email": "ईमेल (ऐच्छिक)",
    "ph.email": "you@example.com",
    "btn.verify": "तपासून पुढे जा",
    "btn.useLocation": "माझे स्थान वापरा",
    "loc.noResults": "निकाल नाहीत",
    "loc.permissionDenied": "स्थान परवानगी नाकारली",

    "edu.title": "शैक्षणिक तपशील",
    "edu.10": "१० वी % / बोर्ड / वर्ष",
    "ph.edu.10": "उदा., 86% CBSE 2018",
    "edu.12": "१२ वी % / बोर्ड / वर्ष",
    "ph.edu.12": "उदा., 90% CBSE 2020",
    "edu.ug": "UG पदवी / शाखा / CGPA",
    "ph.edu.ug": "उदा., B.Tech CSE 8.2",
    "edu.pg": "PG पदवी / शाखा / CGPA",
    "ph.edu.pg": "उदा., M.Tech AI 8.8",
    "edu.extra": "अतिरिक्त पात्रता",
    "ph.edu.extra": "प्रमाणपत्रे, कोर्सेस इ.",
    "edu.resume": "रेझ्युमे अपलोड करा (PDF)",
    "edu.resume.hint": "फक्त PDF, कमाल 5 MB",
    "btn.next": "पुढे",

    "skills.title": "��ुमचे कौशल्य निवडा",
    "skills.addPlaceholder": "कस्टम कौशल्य जोडा",
    "skills.add": "जोडा",
    "skills.minAlert": "किमान एक कौशल्य निवडा.",
    "skills.js": "जावास्क्रिप्ट",
    "skills.py": "पायथन",
    "skills.data": "डेटा विश्लेषण",
    "skills.pm": "प्रोजेक्ट मॅनेजमेंट",
    "skills.policy": "सार्वजनिक धोरण",
    "skills.health": "आरोग्य",
    "skills.sustain": "शाश्वतता",
    "skills.teach": "शिक्षण",
    "skills.hr": "मानव संसाधन",
    "skills.civil": "सिव्हिल अभियांत्रिकी",
    "skills.rural": "ग्रामीण पोहोच",

    "btn.continue": "सुरू ठेवा",

    "rec.title": "शिफारसी",
    "rec.desc": "तुमच्या प्रोफाइल व कौशल्यांवर आधारित शिफारसी दाखविल्या जातील.",
    "btn.back": "मुख्य पृष्ठावर परत जा",
  },
  ta: {
    brand: "பிரதமர் இன்டர்ன்ஷிப் திட்டம்",
    "landing.tagline": "உங்களுக்கு பொருந்தும் இன்டர்ன்ஷிப் கண்டுபிடிக்கவும்",
    "landing.cta": "என் இன்டர்ன்ஷிப் தேடு",
    "landing.desc": "தொழில்நுட்பம், நிதி, கொள்கை, சுகாதாரம் போன்ற துறைகளில் தேர்ந்தெடுக்கப்பட்ட வாய்ப்புகள். உங்கள் சுயவிவரத்திற்கு ஏற்ப.",
    "card.students.title": "மாணவர்கள்",
    "card.students.sub": "பட்டப்படிப்பு மற்றும��� மேல்படிப்புக்கு",
    "card.tech.title": "டெக்-ரெடி",
    "card.tech.sub": "உண்மையான தாக்கம் கொண்ட திட்டங்கள்",
    "card.offices.title": "அலுவலகம் & தொலைதூரம்",
    "card.offices.sub": "அரசு & தனியார் கூட்டாளர்கள்",

    "login.title": "உள்நுழை / பதிவு",
    "field.fullname": "முழு பெயர்",
    "ph.fullname": "உங்கள் முழு பெயரை எழுதவும்",
    "field.age": "வயது",
    "ph.age": "21",
    "field.gender": "பாலினம்",
    "opt.gender.select": "தேர்வு",
    "opt.gender.male": "ஆண்",
    "opt.gender.female": "பெண்",
    "opt.gender.other": "மற்றவை",
    "field.location": "இடம்",
    "ph.location": "நகரம், மாநிலம்",
    "field.phone": "தொலைபேசி எண்",
    "ph.phone": "+91 00000 00000",
    "field.aadhaar": "ஆதார் எண்",
    "ph.aadhaar": "XXXX-XXXX-XXXX",
    "field.email": "மின்னஞ்சல் (விருப்பம���)",
    "ph.email": "you@example.com",
    "btn.verify": "சரிபார்த்து தொடரவும்",
    "btn.useLocation": "என் இருப்பிடத்தை பயன்படுத்து",
    "loc.noResults": "முடிவுகள் இல்லை",
    "loc.permissionDenied": "இருப்பிட அனுமதி மறுக்கப்பட்டது",

    "edu.title": "கல்வி விவரங்கள்",
    "edu.10": "10ம் % / வாரியம் / ஆண்டு",
    "ph.edu.10": "உதா., 86% CBSE 2018",
    "edu.12": "12ம் % / வாரியம் / ஆண்டு",
    "ph.edu.12": "உதா., 90% CBSE 2020",
    "edu.ug": "UG பட்டம் / பிரிவு / CGPA",
    "ph.edu.ug": "உதா., B.Tech CSE 8.2",
    "edu.pg": "PG பட்டம் / பிரிவு / CGPA",
    "ph.edu.pg": "உதா., M.Tech AI 8.8",
    "edu.extra": "கூடுதல் தகுதிகள்",
    "ph.edu.extra": "சான்றிதழ்கள், பாடநெறிகள், முதலியவை",
    "edu.resume": "ரெச்யூமே பதிவேற்று (PDF)",
    "edu.resume.hint": "PDF மட்டும், ���திகபட்சம் 5 MB",
    "btn.next": "அடுத்தது",

    "skills.title": "உங்கள் திறன்களைத் தேர்வு செய்யவும்",
    "skills.addPlaceholder": "சொந்த திறனைச் சேர்க்கவும்",
    "skills.add": "சேர்",
    "skills.minAlert": "குறைந்தது ஒரு திறனைத் தேர்வு செய்யவும்.",
    "skills.js": "ஜாவாஸ்கிரிப்ட்",
    "skills.py": "பைதான்",
    "skills.data": "தரவு பகுப்பாய்வு",
    "skills.pm": "திட்ட மேலாண்மை",
    "skills.policy": "பொது கொள்கை",
    "skills.health": "சுகாதாரம்",
    "skills.sustain": "திடத்தன்மை",
    "skills.teach": "கற்பித்தல்",
    "skills.hr": "மனிதவள மேலாண்மை",
    "skills.civil": "சிவில் என்ஜினியரிங்",
    "skills.rural": "ஊரக தொடர்பு",

    "btn.continue": "தொடரவும்",

    "rec.title": "பரிந்துரைகள்",
    "rec.desc": "உங்கள் சுயவிவரமும் திறன்களும் அடிப்படையில் பரிந்துரைகள் காட்டப்படும்.",
    "btn.back": "முகப்புக்கு திரும்ப",
  },
};

const LANGUAGE_MAP = {
  English: "en",
  Hindi: "hi",
  Tamil: "ta",
  Bengali: "bn",
  Marathi: "mr",
  Telugu: "te",
};

function t(lang, key) {
  return (translations[lang] && translations[lang][key]) || translations.en[key] || key;
}

function applyTranslations(lang) {
  document.querySelectorAll("[data-i18n]").forEach((el) => {
    const key = el.getAttribute("data-i18n");
    if (!key) return;
    el.textContent = t(lang, key);
  });
  document.querySelectorAll("[data-i18n-ph]").forEach((el) => {
    const key = el.getAttribute("data-i18n-ph");
    if (!key) return;
    el.setAttribute("placeholder", t(lang, key));
  });
  document.querySelectorAll("option[data-i18n]").forEach((opt) => {
    const key = opt.getAttribute("data-i18n");
    if (!key) return;
    opt.textContent = t(lang, key);
  });
}

function debounce(fn, delay) {
  let id;
  return (...args) => {
    clearTimeout(id);
    id = setTimeout(() => fn(...args), delay);
  };
}

function buildSuggestionLabel(item) {
  if (item && item.address) {
    const { city, town, village, state_district, state, county, country } = item.address;
    const parts = [city || town || village, state_district || state || county, country].filter(Boolean);
    return parts.join(", ");
  }
  return item.display_name || "";
}

document.addEventListener("DOMContentLoaded", () => {
  const langSel = document.getElementById("language");
  const saved = sessionStorage.getItem("lang") || "English";
  if (langSel) langSel.value = saved;
  const langCode = LANGUAGE_MAP[saved] || "en";
  document.documentElement.setAttribute("lang", langCode);
  document.documentElement.setAttribute("dir", "ltr");
  applyTranslations(langCode);

  if (langSel) {
    langSel.addEventListener("change", () => {
      sessionStorage.setItem("lang", langSel.value);
      const code = LANGUAGE_MAP[langSel.value] || "en";
      document.documentElement.setAttribute("lang", code);
      document.documentElement.setAttribute("dir", "ltr");
      applyTranslations(code);
    });
  }

  // Location autocomplete + geolocation (login page)
  const locInput = document.getElementById("location");
  const useMyLocation = document.getElementById("use-my-location");
  const sugg = document.getElementById("location-suggestions");
  let activeIndex = -1;
  let items = [];
  let aborter = null;

  function hideSuggestions() {
    if (sugg) {
      sugg.hidden = true;
      sugg.innerHTML = "";
      activeIndex = -1;
      items = [];
    }
  }
  function renderSuggestions(list, code) {
    if (!sugg) return;
    sugg.innerHTML = "";
    if (!list.length) {
      const empty = document.createElement("div");
      empty.className = "suggestion-empty";
      empty.textContent = t(code, "loc.noResults");
      sugg.appendChild(empty);
      sugg.hidden = false;
      return;
    }
    list.forEach((it, idx) => {
      const div = document.createElement("div");
      div.className = "suggestion-item";
      div.textContent = buildSuggestionLabel(it);
      div.addEventListener("mousedown", (e) => {
        e.preventDefault();
        selectSuggestion(idx);
      });
      sugg.appendChild(div);
    });
    sugg.hidden = false;
  }
  function updateActive() {
    if (!sugg) return;
    const children = Array.from(sugg.children);
    children.forEach((el, i) => el.classList?.toggle("active", i === activeIndex));
  }
  function selectSuggestion(idx) {
    const it = items[idx];
    if (!it) return;
    locInput.value = buildSuggestionLabel(it);
    hideSuggestions();
    sessionStorage.setItem("locationLabel", locInput.value);
  }
  const fetchSuggestions = debounce(async (q) => {
    if (!q || q.trim().length < 2) {
      hideSuggestions();
      return;
    }
    try {
      if (aborter) aborter.abort();
      aborter = new AbortController();
      const sel = document.getElementById("language");
      const code = LANGUAGE_MAP[sel?.value || "English"] || "en";
      const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(q)}&addressdetails=1&limit=6&accept-language=${code}`;
      const res = await fetch(url, {
        headers: { Accept: "application/json", "User-Agent": "PM-Internship-Scheme Demo" },
        signal: aborter.signal,
      });
      if (!res.ok) throw new Error("net");
      const data = await res.json();
      items = Array.isArray(data) ? data : [];
      renderSuggestions(items, code);
    } catch (e) {
      if (e.name === "AbortError") return;
      hideSuggestions();
    }
  }, 250);

  if (locInput) {
    locInput.addEventListener("input", () => fetchSuggestions(locInput.value));
    locInput.addEventListener("keydown", (e) => {
      if (sugg?.hidden) return;
      const max = items.length - 1;
      if (e.key === "ArrowDown") {
        e.preventDefault();
        activeIndex = Math.min(max, activeIndex + 1);
        updateActive();
      } else if (e.key === "ArrowUp") {
        e.preventDefault();
        activeIndex = Math.max(0, activeIndex - 1);
        updateActive();
      } else if (e.key === "Enter") {
        if (activeIndex >= 0) {
          e.preventDefault();
          selectSuggestion(activeIndex);
        }
      } else if (e.key === "Escape") {
        hideSuggestions();
      }
    });
    document.addEventListener("click", (e) => {
      if (!sugg?.contains(e.target) && e.target !== locInput) hideSuggestions();
    });
  }

  async function reverseGeocode(lat, lon) {
    const sel = document.getElementById("language");
    const code = LANGUAGE_MAP[sel?.value || "English"] || "en";
    const url = `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json&addressdetails=1&accept-language=${code}`;
    const res = await fetch(url, { headers: { Accept: "application/json", "User-Agent": "PM-Internship-Scheme Demo" } });
    if (!res.ok) throw new Error("net");
    const data = await res.json();
    return buildSuggestionLabel(data);
  }
  if (useMyLocation && locInput) {
    useMyLocation.addEventListener("click", () => {
      if (!navigator.geolocation) return alert("Geolocation not supported");
      navigator.geolocation.getCurrentPosition(
        async (pos) => {
          try {
            const label = await reverseGeocode(pos.coords.latitude, pos.coords.longitude);
            locInput.value = label || "";
            sessionStorage.setItem("locationLabel", locInput.value);
          } catch (err) {
            alert("Network error while detecting location");
          }
        },
        () => {
          const sel = document.getElementById("language");
          const code = LANGUAGE_MAP[sel?.value || "English"] || "en";
          alert(t(code, "loc.permissionDenied"));
        },
        { enableHighAccuracy: true, timeout: 10000, maximumAge: 60000 }
      );
    });
  }

  // Skills page behavior (multi-select + custom skills)
  const skillsPage = document.getElementById("skills-page");
  if (skillsPage) {
    const chipsWrap = document.getElementById("skills-chips");
    const selectedWrap = document.getElementById("skills-selected");
    const customInput = document.getElementById("custom-skill");
    const addBtn = document.getElementById("add-skill");
    const goBtn = document.getElementById("skills-continue");

    const selected = new Set(JSON.parse(sessionStorage.getItem("selectedSkills") || "[]"));

    function renderSelected() {
      if (!selectedWrap) return;
      selectedWrap.innerHTML = "";
      Array.from(selected).forEach((skill) => {
        const b = document.createElement("button");
        b.className = "chip active";
        b.type = "button";
        b.textContent = skill;
        b.dataset.skill = skill;
        b.addEventListener("click", () => {
          selected.delete(skill);
          persist();
          renderSelected();
          markChips();
        });
        selectedWrap.appendChild(b);
      });
    }
    function persist() {
      sessionStorage.setItem("selectedSkills", JSON.stringify(Array.from(selected)));
    }
    function markChips() {
      chipsWrap?.querySelectorAll(".chip").forEach((ch) => {
        const s = ch.getAttribute("data-skill");
        if (!s) return;
        ch.classList.toggle("active", selected.has(s));
      });
    }

    chipsWrap?.addEventListener("click", (e) => {
      const target = e.target.closest(".chip");
      if (!target) return;
      const s = target.getAttribute("data-skill");
      if (!s) return;
      if (selected.has(s)) selected.delete(s);
      else selected.add(s);
      persist();
      markChips();
      renderSelected();
    });

    addBtn?.addEventListener("click", () => {
      const val = (customInput?.value || "").trim();
      if (!val) return;
      selected.add(val);
      customInput.value = "";
      persist();
      renderSelected();
      markChips();
    });

    renderSelected();
    markChips();

    goBtn?.addEventListener("click", () => {
      if (selected.size === 0) {
        const sel = document.getElementById("language");
        const code = LANGUAGE_MAP[sel?.value || "English"] || "en";
        alert(t(code, "skills.minAlert"));
        return;
      }
      window.location.href = "recommend.html";
    });
  }
});
