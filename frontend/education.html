<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-i18n="edu.title">Education Details</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div class="section land-bg min-h-screen center" style="padding:40px;">
    <div class="grad-a"></div>
    <div class="grad-b"></div>

    <div class="lang">
      <select id="language" class="select">
        <option>English</option>
        <option>Hindi</option>
        <option>Tamil</option>
        <option>Bengali</option>
        <option>Marathi</option>
        <option>Telugu</option>
      </select>
    </div>

    <div class="container form-wrap">
      <div class="form-card">
        <h1 class="h1" style="font-size:32px;margin:0 0 16px;" data-i18n="edu.title">Education Details</h1>
        
        <!-- Removed action="skills.html" because we'll handle it with JS -->
        <form class="form-grid form-grid-2" id="eduForm">
          <div>
            <label class="label" for="tenth">10th % / Board / Year</label>
            <input class="input" id="tenth" name="tenth" placeholder="e.g., 86% CBSE 2018" />
          </div>
          <div>
            <label class="label" for="twelfth">12th % / Board / Year</label>
            <input class="input" id="twelfth" name="twelfth" placeholder="e.g., 90% CBSE 2020" />
          </div>
          <div>
            <label class="label" for="ug">UG Degree / Branch / CGPA</label>
            <input class="input" id="ug" name="ug" placeholder="e.g., B.Tech CSE 8.2" />
          </div>
          <div>
            <label class="label" for="pg">PG Degree / Branch / CGPA</label>
            <input class="input" id="pg" name="pg" placeholder="e.g., M.Tech AI 8.8" />
          </div>
          <div style="grid-column:1/-1;">
            <label class="label" for="extra">Extra Qualifications</label>
            <input class="input" id="extra" name="extra" placeholder="Certifications, Courses, etc." />
          </div>
          <div style="grid-column:1/-1;">
            <label class="label" for="resume">Upload Resume (PDF)</label>
            <input class="input" id="resume" name="resume" type="file" accept="application/pdf" />
            <small class="hint">PDF only, max 5 MB</small>
          </div>
          <div style="grid-column:1/-1;">
            <button class="btn btn-block" type="submit">Next</button>
          </div>
        </form>

        <!-- Where recommendations will show -->
        <div id="recommendations" style="margin-top:20px;"></div>
      </div>
    </div>
  </div>

 <script>
  const form = document.getElementById("eduForm");
  const resumeInput = document.getElementById("resume");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const file = resumeInput.files[0];
    if (!file) {
      alert("Please upload a resume first!");
      return;
    }

    const formData = new FormData();
    formData.append("file", file);

    try {
      const response = await fetch("http://127.0.0.1:8000/match-resume", {
        method: "POST",
        body: formData,
      });

      if (!response.ok) throw new Error("Failed to upload resume");

      const data = await response.json();

      // Save recommendations to localStorage
      localStorage.setItem("recommendations", JSON.stringify(data.recommendations));

      // Redirect to recommendations page
      window.location.href = "recommendations.html";
    } catch (err) {
      console.error(err);
      alert("Error fetching recommendations");
    }
  });
</script>

</body>
</html>
